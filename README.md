# Android CamSwap (Open Source)
æ„Ÿè°¢é¡¹ç›® [android_virtual_cam](https://github.com/w2016561536/android_virtual_cam) ä¸ºæœ¬é¡¹ç›®æä¾›çš„çµæ„Ÿå’Œä»£ç åŸºç¡€ã€‚

Android CamSwap æ˜¯ä¸€ä¸ªåŸºäº Xposed æ¡†æ¶çš„è™šæ‹Ÿæ‘„åƒå¤´æ¨¡å—ã€‚å®ƒèƒ½å¤Ÿæ‹¦æˆª Android ç³»ç»Ÿç›¸æœºçš„é¢„è§ˆå’Œæ‹ç…§è¯·æ±‚ï¼Œå¹¶å°†é¢„è§ˆç”»é¢æ›¿æ¢ä¸ºç”¨æˆ·æŒ‡å®šçš„è§†é¢‘ã€‚

æœ¬é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„ Android å¼€å‘æŠ€æœ¯æ ˆï¼ˆKotlin, Jetpack Composeï¼‰é‡æ„ï¼Œå¹¶å¼•å…¥äº†åŸºäº ContentProvider çš„è·¨è¿›ç¨‹æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œå…¼å®¹é«˜ç‰ˆæœ¬ Android (11+) çš„æ–‡ä»¶æƒé™éš”ç¦»ã€‚

å…·ä½“å®ç°æ–¹å¼æŸ¥çœ‹ä»“åº“ä¸­çš„ `code description.md` æ–‡ä»¶ï¼ˆä»…é€‚ç”¨v2.0å‰ç‰ˆæœ¬ï¼‰ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

*   **å…¨ API æ”¯æŒ**ï¼šåŒæ—¶æ”¯æŒ Camera1 (Camera) å’Œ Camera2 (CameraDevice) APIã€‚
*   **è§†é¢‘æ›¿æ¢é¢„è§ˆ** ğŸ¥ï¼šå°†ç›¸æœºé¢„è§ˆç”»é¢æ— ç¼æ›¿æ¢ä¸ºæŒ‡å®šçš„ MP4 è§†é¢‘ã€‚
*   **éŸ³é¢‘æ›¿æ¢** ğŸ¤ï¼šå¯é€‰æ‹©æ’­æ”¾è‡ªå®šä¹‰ MP3 éŸ³é¢‘æ–‡ä»¶ï¼Œæˆ–ä¸æ›¿æ¢è§†é¢‘åŒæ­¥ã€‚
*   **é€šçŸ¥æ å®æ—¶æ§åˆ¶**ï¼š
    *   â­ åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª / ä¸Šä¸€ä¸ªè§†é¢‘ã€‚
    *   ğŸ”„ å¿«é€Ÿè°ƒæ•´è§†é¢‘æ—‹è½¬æ–¹å‘ï¼ˆ+90Â° / -90Â°ï¼‰ã€‚
    *   ğŸ² éšæœºæ’­æ”¾æ¨¡å¼ã€‚
*   **è‡ªåŠ¨æ—‹è½¬å¤„ç†**ï¼šè¯»å–è§†é¢‘å…ƒæ•°æ®ä¸­çš„æ—‹è½¬è§’åº¦ï¼Œé€šè¿‡ OpenGL ES æ­£ç¡®æ¸²æŸ“ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†ã€‚
*   **è·¨è¿›ç¨‹é…ç½®åŒæ­¥**ï¼š
    *   ä¸»è·¯å¾„ï¼šContentProvider IPCï¼ˆæ— éœ€ç›®æ ‡åº”ç”¨å­˜å‚¨æƒé™ï¼‰ã€‚
    *   å›é€€è·¯å¾„ï¼šç›´æ¥æ–‡ä»¶è¯»å– + Application å†·å¯åŠ¨é¢„çƒ­ï¼Œå½»åº•è§£å†³å†·å¯åŠ¨æ—¶é…ç½®æœªå°±ç»ªé—®é¢˜ã€‚
*   **ç›®æ ‡åº”ç”¨è¿‡æ»¤**ï¼šå¯æŒ‡å®šæ¨¡å—ä»…åœ¨ç‰¹å®šåº”ç”¨ä¸­ç”Ÿæ•ˆã€‚
*   **ç°ä»£åŒ– UI**ï¼šåŸºäº Material Design 3 å’Œ Jetpack Compose æ„å»ºçš„ç®¡ç†ç•Œé¢ã€‚

## ğŸ“± ç¯å¢ƒè¦æ±‚

*   **Android ç‰ˆæœ¬**ï¼šAndroid 8.0 (API 26) åŠä»¥ä¸Šï¼ˆæ¨è Android 11+ï¼‰
*   **Root æƒé™**ï¼šå¿…é¡»
*   **Xposed æ¡†æ¶**ï¼šæ¨èä½¿ç”¨ [LSPosed](https://github.com/LSPosed/LSPosed)ï¼ˆZygisk / Riru ç‰ˆæœ¬å‡å¯ï¼‰

## ğŸš€ å®‰è£…ä¸ä½¿ç”¨

### 1. å®‰è£…æ¨¡å—
1. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ Release APKã€‚
2. å®‰è£…åˆ°ä½ çš„ Android è®¾å¤‡ã€‚
3. åœ¨ **LSPosed ç®¡ç†å™¨**ä¸­å¯ç”¨è¯¥æ¨¡å—ã€‚
4. **ä½œç”¨åŸŸå‹¾é€‰**ï¼š
    *   **å¼ºçƒˆå»ºè®®**ï¼šå‹¾é€‰ã€Œç³»ç»Ÿæ¡†æ¶ (System Framework)ã€ä»¥è·å¾—æœ€ä½³å…¼å®¹æ€§ã€‚
    *   æˆ–è€…ï¼šä»…å‹¾é€‰ä½ éœ€è¦è¿›è¡Œæ›¿æ¢çš„**ç›®æ ‡åº”ç”¨**ï¼ˆå¦‚ç›¸æœºã€å¾®ä¿¡ã€æŠ–éŸ³ç­‰ï¼‰ã€‚
5. é‡å¯æ‰‹æœºï¼ˆæˆ–é‡å¯ç›®æ ‡åº”ç”¨çš„è¿›ç¨‹ï¼‰ã€‚

### 2. é…ç½®ç´ æ
1. æ‰“å¼€ **CamSwap** åº”ç”¨ï¼Œæˆäºˆå¿…è¦çš„æ–‡ä»¶è¯»å†™æƒé™ã€‚
2. åœ¨ã€Œç®¡ç†ã€é¡µé¢å¯¼å…¥ä½ çš„ MP4 è§†é¢‘ç´ æã€‚
3. åœ¨ã€Œè®¾ç½®ã€é¡µé¢é€‰æ‹©é»˜è®¤è§†é¢‘ã€é…ç½®éŸ³é¢‘æ›¿æ¢ã€å¼€å¯é€šçŸ¥æ æ§åˆ¶ç­‰é€‰é¡¹ã€‚

### 3. å¼€å§‹ä½¿ç”¨
æ‰“å¼€ä»»æ„è°ƒç”¨ç›¸æœºçš„åº”ç”¨ï¼Œé¢„è§ˆç”»é¢å°†è¢«æ›¿æ¢ä¸ºä½ é€‰æ‹©çš„è§†é¢‘ã€‚

> **æç¤º**ï¼šè‹¥è§†é¢‘ç”»é¢æ–¹å‘ä¸æ­£ç¡®ï¼Œå¯åœ¨é€šçŸ¥æ ä½¿ç”¨æ—‹è½¬æŒ‰é’®å¾®è°ƒï¼Œæˆ–åœ¨è®¾ç½®ä¸­æ‰‹åŠ¨å¡«å†™æ—‹è½¬åç§»è§’åº¦ã€‚

## ğŸ“ é…ç½®æ–‡ä»¶

æ¨¡å—çš„é…ç½®å­˜å‚¨åœ¨ä»¥ä¸‹è·¯å¾„ï¼ˆJSON æ ¼å¼ï¼‰ï¼š
```
/sdcard/DCIM/Camera1/cs_config.json
```

ç›®æ ‡è§†é¢‘æ–‡ä»¶ä¹Ÿåº”æ”¾ç½®åœ¨è¯¥ç›®å½•ä¸‹ã€‚æ¨¡å—é‡å¯åä¼šè‡ªåŠ¨è¯»å–ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

Hook å±‚ï¼ˆXposed æ¨¡å—æ ¸å¿ƒï¼‰é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼š

| æ¨¡å— | æ–‡ä»¶ | èŒè´£ |
|------|------|------|
| **å…¥å£** | `HookMain.java` | Xposed å…¥å£ + å…±äº«çŠ¶æ€ + å§”æ‰˜åˆ†å‘ |
| **æ’­æ”¾å™¨ç®¡ç†** | `MediaPlayerManager.java` | 6 ç»„ MediaPlayer/GLVideoRenderer/SurfaceRelay çš„ç”Ÿå‘½å‘¨æœŸ |
| **é…ç½®ç›‘å¬** | `ConfigWatcher.java` | ContentObserver + FileObserver + BroadcastReceiver |
| **Camera2 æ‹¦æˆª** | `Camera2SessionHook.java` | Camera2 session åˆ›å»ºæ‹¦æˆª + è™šæ‹Ÿ Surface ç®¡ç† |
| **Camera2 Hook** | `Camera2Handler.java` | Camera2 CaptureRequest.Builder + Surface æ›¿æ¢ |
| **Camera1 Hook** | `Camera1Handler.java` | Camera1 é¢„è§ˆ Hook + onPreviewFrame å¸§æ›¿æ¢ |
| **éŸ³é¢‘ Hook** | `MicrophoneHandler.java` | AudioRecord æ‹¦æˆª + MP3 éŸ³é¢‘æ›¿æ¢ |


## ğŸ› ï¸ ç¼–è¯‘æŒ‡å—

### å‡†å¤‡ç¯å¢ƒ
*   JDK 17+
*   Android SDK Platform 34

### å…‹éš†ä»“åº“
```bash
git clone https://github.com/zensu357/Android-CamSwap-OpenSource.git
cd Android-CamSwap-OpenSource
```

### é…ç½®ç­¾åï¼ˆå¯é€‰ï¼‰
ç¼–è¯‘ Debug åŒ…æ— éœ€ä»»ä½•ç­¾åé…ç½®ï¼Œç›´æ¥è¿è¡Œï¼š
```bash
./gradlew assembleDebug
```

å¦‚éœ€ç¼–è¯‘å·²ç­¾åçš„ Release åŒ…ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `local.properties`ï¼ˆå‹¿æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰å¹¶å¡«å†™ï¼š
```properties
sdk.dir=/path/to/your/android/sdk
storeFile=../camswap_release.jks
storePassword=your_password
keyAlias=your_alias
keyPassword=your_key_password
```

è‹¥æœªé…ç½®ç­¾åï¼ŒRelease æ„å»ºä¼š**è‡ªåŠ¨å›é€€åˆ° Debug å¯†é’¥ç­¾å**ï¼Œä»å¯æ­£å¸¸å®‰è£…ã€‚

```bash
# ç¼–è¯‘ Release åŒ…
./gradlew assembleRelease
```

ç¼–è¯‘äº§ç‰©ä½äº `app/build/outputs/apk/` ç›®å½•ä¸‹ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“ã€‚
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/AmazingFeature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add some AmazingFeature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/AmazingFeature`
5. å¼€å¯ Pull Requestã€‚

## âš ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›**å®‰å…¨ç ”ç©¶ã€è½¯ä»¶æµ‹è¯•å’Œæ•™è‚²ç›®çš„**ä½¿ç”¨ã€‚  
è¯·å‹¿å°†æœ¬é¡¹ç›®ç”¨äºä»»ä½•éæ³•ç”¨é€”ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºäººè„¸è¯†åˆ«ç»•è¿‡ã€èº«ä»½æ¬ºè¯ˆç­‰ï¼‰ã€‚  
ä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…å› ä½¿ç”¨æœ¬é¡¹ç›®è€Œäº§ç”Ÿçš„ä¸€åˆ‡æ³•å¾‹è´£ä»»ã€‚

## â¤ï¸ æ”¯æŒ

å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹ â­ Star æ”¯æŒï¼

![Star History](https://api.star-history.com/svg?repos=zensu357/Android-CamSwap-OpenSource&type=20260219)

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [MIT è®¸å¯è¯](LICENSE) å¼€æºã€‚
